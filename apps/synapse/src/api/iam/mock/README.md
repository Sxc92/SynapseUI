# 权限分配 Mock 数据使用说明

## 概述

Mock 数据用于前端开发和测试，无需后端接口即可验证权限分配功能。

## 启用 Mock 数据

### 方式1：环境变量（推荐）

在项目根目录创建或修改 `.env.development` 文件：

```bash
VITE_USE_MOCK=true
```

或者：

```bash
VITE_USE_MOCK=1
```

### 方式2：直接修改代码（快速测试）

在 `apps/synapse/src/api/iam/` 目录下的相关 API 文件中，将条件判断改为：

```typescript
// 开发环境使用 Mock 数据
const useMock = import.meta.env.DEV;  // 移除 VITE_USE_MOCK 检查，开发环境直接使用 Mock
if (useMock) {
  const { mockPermissionApi } = await import('./mock/permission');
  return mockPermissionApi.getSystemList();
}
```

**注意：** 方式2 会在所有开发环境启用 Mock，建议测试完成后改回方式1。

## Mock 数据说明

### 系统数据
- `sys-001`: 系统管理
- `sys-002`: 用户管理
- `sys-003`: 订单管理

### 菜单数据
- 支持两级菜单结构
- 系统1（系统管理）：
  - 系统配置（一级）
    - 基础配置（二级）
    - 高级配置（二级）
  - 角色管理（一级）
- 系统2（用户管理）：
  - 用户列表（一级）
    - 活跃用户（二级）
  - 用户资料（一级）
- 系统3（订单管理）：
  - 订单列表（一级）

### 资源数据
- 每个菜单下都有对应的资源（BUTTON 和 API）
- 资源包含权限编码（code），用于权限检查

### 角色权限数据
- `role-001`: 部分选中（系统1和系统2的部分权限）
- `role-002`: 全选系统1的所有权限
- `role-003`: 空权限（用于测试新角色）

## 测试场景

### 场景1：查看已分配权限
1. 打开权限分配弹窗，roleId 使用 `role-001`
2. 应该看到系统1和系统2被选中
3. 应该看到部分菜单和资源被选中

### 场景2：分配新权限
1. 打开权限分配弹窗，roleId 使用 `role-003`
2. 选择系统、菜单、资源
3. 点击保存
4. 再次打开应该看到已保存的权限

### 场景3：三级联动测试
1. 选择资源 → 应该自动选中菜单和系统
2. 选择菜单 → 应该自动选中系统
3. 选择系统 → 应该自动选中所有菜单和资源
4. 取消系统 → 应该自动取消所有菜单和资源

## 注意事项

1. Mock 数据只在开发环境生效（`import.meta.env.DEV`）
2. 生产环境会自动使用真实 API
3. Mock 数据的保存操作会更新内存中的数据，刷新页面后会重置
4. 可以根据需要修改 `mock/permission.ts` 中的数据

